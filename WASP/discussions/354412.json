[
  {
    "Id": "831686",
    "ThreadId": "354412",
    "Html": "\r\n<p>I was having trouble figuring out a good way to start a new process and then immediately grab its window. Start-Process -passThru is useful, but you can run into some issues if trying something like this:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:orangered\">$process</span> <span style=\"color:gray\">=</span> Start<span style=\"color:gray\">-</span>Process <span style=\"color:gray\">-</span>passThru notepad.exe\r\nSelect<span style=\"color:gray\">-</span>Window <span style=\"color:orangered\">$process</span>\r\n</pre>\r\n</div>\r\n<p>Why doesn't this work?</p>\r\n<ul>\r\n<li>The process's window may not be immediately available so Select-Window doesn't return anything if it's called right after the Start-Process command.\r\n</li><li>The process ID of a started process doesn't always match the Window that was created\r\n</li><li>If you have multiple windows already open for that process, it's hard to select the right one.\r\n</li></ul>\r\n<p>To workaround this issue, I created a function called Select-WindowStarted which will start a process and then return the new window that was opened. I tested it for notepad, Firefox, and Chrome. I'm going to maintain this function in my PS profile at&nbsp;<a title=\"common.windowsetup.ps1\" href=\"https://benmccormack.kilnhg.com/Code/Public/Group/WindowsPowerShell/File/common.windowsetup.ps1?rev=tip\">common.windowsetup.ps1</a>.\r\n Here's the first version of the function so you can get the basic idea here:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">function</span> Select<span style=\"color:gray\">-</span>WindowStarted(<span style=\"color:orangered\">$process</span>, <span style=\"color:gray\">[</span><span style=\"color:teal\">string</span><span style=\"color:gray\">]</span><span style=\"color:orangered\">$processName</span> <span style=\"color:gray\">=</span> <span style=\"color:#a31515\">&quot;&quot;</span>, <span style=\"color:orangered\">$msTimeout</span> <span style=\"color:gray\">=</span> 1000){\r\n    <span style=\"color:orangered\">$startTime</span> <span style=\"color:gray\">=</span> get<span style=\"color:gray\">-</span>date\r\n    <span style=\"color:orangered\">$endTime</span> <span style=\"color:gray\">=</span> <span style=\"color:orangered\">$startTime</span>.addMilliseconds(<span style=\"color:orangered\">$msTimeout</span>)\r\n    \r\n    <span style=\"color:blue\">if</span> (<span style=\"color:orangered\">$processName</span> <span style=\"color:gray\">-eq</span> <span style=\"color:#a31515\">&quot;&quot;</span>){\r\n        <span style=\"color:orangered\">$processName</span> <span style=\"color:gray\">=</span> <span style=\"color:orangered\">$process</span>\r\n    }\r\n\r\n    <span style=\"color:orangered\">$currentWindows</span> <span style=\"color:gray\">=</span> Select<span style=\"color:gray\">-</span>Window <span style=\"color:orangered\">$processName</span>\r\n\r\n    <span style=\"color:orangered\">$processID</span> <span style=\"color:gray\">=</span> Start<span style=\"color:gray\">-</span>Process <span style=\"color:orangered\">$process</span> <span style=\"color:gray\">-</span>passThru\r\n\r\n    <span style=\"color:blue\">do</span> {\r\n        <span style=\"color:blue\">if</span>((get<span style=\"color:gray\">-</span>date) <span style=\"color:gray\">-gt</span> <span style=\"color:orangered\">$endTime</span>){\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:#a31515\">&quot;Timeout while trying to Select window by process&quot;</span>\r\n        }\r\n    }\r\n    <span style=\"color:blue\">while</span> ((Select<span style=\"color:gray\">-</span>Window <span style=\"color:orangered\">$processName</span> | where {!(<span style=\"color:orangered\">$currentWindows</span> <span style=\"color:gray\">-contains</span> <span style=\"color:orangered\">$_</span>)} | measure).count <span style=\"color:gray\">-eq</span> 0)\r\n    \r\n    Select<span style=\"color:gray\">-</span>Window <span style=\"color:orangered\">$processName</span> | where {!(<span style=\"color:orangered\">$currentWindows</span> <span style=\"color:gray\">-contains</span> <span style=\"color:orangered\">$_</span>)}\r\n}\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2012-05-03T08:33:20.337-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "832435",
    "ThreadId": "354412",
    "Html": "<p>Looks good - I can't think of any other way to make sure you got the newest window when there are multiples for the same process id.</p>",
    "PostedDate": "2012-05-04T21:32:14.423-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]